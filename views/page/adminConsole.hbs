<body id="page-top" class="index">
<script src="/javascripts/Chart.min.js"></script>
<!-- jQuery -->
<script src="/vendor/jquery/jquery.min.js"></script>


<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/css/bootstrap-datepicker.css"
      rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/js/bootstrap-datepicker.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
</head>


<!--</style>-->


<!-- Navigation -->
<nav id="mainNav" class="navbar navbar-default navbar-custom navbar-fixed-top"
     style="background-color:#222222;padding:10px 0;">
    <div class="container">

        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i>
            </button>
            <a class="navbar-brand page-scroll" href="#page-top"><img src="/img/crow-logo.png" alt="CROW Logo"
                                                                      style="width:auto;height:40px;border:0;"/></a>
        </div>


        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

            <div class="row">

                <div class="col-md-6 text-center" style="color: white;">
                    <h2>

                        Welcome,{{firstname}}

                    </h2>
                </div>
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a class="page-scroll " href="/page/adminUserApproval">Approve/Deny Users</a>
                    </li>
                    <li>
                        <a class="page-scroll " href="/page/adminContactUs">View Forms</a>
                    </li>
                    <li>

                        <a href="/page/logout" class="solutions-link btn btn-primary btn-sm" data-toggle="modal"
                           style="border-radius: 3px;">Logout</a>
                    </li>
                </ul>

            </div>

        </div>


    </div>

</nav>


<section id="overview" class="bg-light-gray">
    <div class="container" style="width:80%;">


        <div class="row">
            <div class="col-lg-10 text-center">
                <h5>SortBy: <span id="sortbyMtd" style="text-decoration: underline;"></span> | Year: <span id="yearmtd"
                                                                                                           style="text-decoration: underline;"></span>
                    | Month: <span id="monthmtd" style="text-decoration: underline;"></span> | Displayed User: <span
                            id="usermtd" style="text-decoration: underline;"></span></h5>

                <div id="canvasChartjs">
                    <canvas id="myChart"></canvas>
                </div>


            </div>
            <div class="col-lg-2 text-center">


                <div class="panel-body">
                    <label>Sort by: </label>
                    <select id="sortBy" class="form-control" name="sortBy" onchange="myFunction()" required>
                        <option value="">Select a option</option>
                        <option value="year">Year</option>
                        <option value="month">Month</option>
                    </select>
                </div>
                <div id="userselect" class="panel-body userselect">
                    <label>User Options: </label>
                    <input id="userselection" name="userselection" class="form-control" type="text">

                    <button type="button" onclick="findCloesetUser()" id="findcloestuser"
                            class="btn btn-primary btn-sm">Find closest user
                    </button>
                    <select id="sectorSelectjs" class="form-control" name="workSector" onchange="selectorChange()"
                            required>


                        <option value=""></option>


                    </select>

                    <input class="form-check-input" type="checkbox" value="" id="defaultCheck1"
                           onclick="oncheckboxcheck()">

                    <label class="form-check-label" for="defaultCheck1"></label>
                    Show all users


                </div>

                <div class="panel-body">
                    <label>Select Year: </label>
                    <input name="year" class="form-control" type="text" id="datepickeryear">


                </div>
                <div id="monthSelect" class="panel-body monthdisplay" style="visibility: hidden">
                    <label>Select Month: </label>
                    <input name="month" class="form-control" type="text" id="datepickermonth">


                </div>
                <!--onclick="getinputdat()"-->
                <button onclick="getinputdat()" type="button" class="btn btn-primary btn-md">Show</button>
                <!--<button onclick="testingfunction()" type="button" class="btn btn-primary btn-md">Show</button>-->
                <br>
                <br>


                <!--</form>-->

            </div>

        </div>


    </div>
</section>

<script>
    $(function () {
        $("#datepickeryear").datepicker({
            minViewMode: 'years',
            autoclose: true,
            format: 'yyyy'
        });

        $("#datepickermonth").datepicker({
            minViewMode: 'months',
            autoclose: true,
            format: 'MM'
        });


        var senddat = {
            emailAddress: '{{emailAddress}}',
            session: '{{session}}',
            sortby: "year",
            year: "2018",
            month: "",
            user: ""

        };

        socket.emit("reqgraphdata", senddat)


    });


    function newGraphData(graph1, graph2, graph3) {
        console.log(graph1);
        console.log(graph2);
        console.log(graph3);
        // var element = document.getElementById("myChart");
        //
        //  element.parentNode.removeChild(element);
        if (window.myNewChart1 != null) {
            window.myNewChart1.destroy();
        }


        var ctx = document.getElementById('myChart').getContext('2d');
        window.myNewChart1 = new Chart(ctx, {
            // The type of chart we want to create
            type: 'line',

            // The data for our dataset
            data: {
                labels: graph1,
                datasets: [{
                    label: "Login",
                    borderColor: 'rgb(255, 99, 132)',
                    data: graph2,
                    fill: false
                }, {
                    label: "Register",
                    borderColor: 'rgb(0, 191, 255)',
                    data: graph3,
                    fill: false
                }]
            },

            // Configuration options go here
            options: {}
        });
        Chart.defaults.global.animation.duration = 3000;


    }


    //  function removeData(chart) {
    //      chart.data.labels.pop();
    //      chart.data.datasets.forEach((dataset) => {
    //          dataset.data.pop();
    //      });
    //      chart.update();
    //  }
    //
    // function addData(chart, label, data) {
    //      chart.data.labels.push(label);
    //      chart.data.datasets.forEach((dataset) => {
    //          dataset.data.push(data);
    //      });
    //      chart.update();
    //  }


    function selectorChange() {
        console.log("DUN HELLO");
        var x = document.getElementById("sectorSelectjs").value;
        console.log(x);



        document.getElementById("userselection").value = x.split(" ")[0];
    }


    function oncheckboxcheck() {
        if (document.getElementById("defaultCheck1").checked) {
            document.getElementById("userselection").value = "All";
            document.getElementById("sectorSelectjs").value = "All";
            document.getElementById("userselection").setAttribute("readonly", true);
            document.getElementById("sectorSelectjs").setAttribute("readonly", true);
            document.getElementById("findcloestuser").style.visibility = "hidden";

        } else {
            document.getElementById("userselection").value = "";
            document.getElementById("sectorSelectjs").val = "";
            document.getElementById("userselection").removeAttribute("readonly");
            document.getElementById("sectorSelectjs").removeAttribute("readonly");
            document.getElementById("findcloestuser").style.visibility = "visible";
        }

    }

    var socket = io();

    function getinputdat() {
        var sortby = document.getElementById("sortBy").value;
        var year = document.getElementById("datepickeryear").value;
        var month = document.getElementById("datepickermonth").value;
        var userselection = document.getElementById("userselection").value;

        console.log(sortby);
        console.log(year);
        console.log(month);


        var senddat = {
            emailAddress: '{{emailAddress}}',
            session: '{{session}}',
            sortby: sortby,
            year: year,
            month: month,
            user: userselection
        };

        socket.emit("reqgraphdata", senddat)


    }

    function findCloesetUser() {
        console.log("RUNN");
        let username = document.getElementById("userselection").value;
        console.log(username);


        let toSendSocket = {
            username: username,
            emailAddress: '{{emailAddress}}',
            session: '{{session}}'


        };

        socket.emit("findcloestUserAdm", toSendSocket);

    }

    socket.on("sendlistofusers", function (data) {

        console.log(data);

        var select = document.getElementById("sectorSelectjs");


        while (select.options.length > 0) {
            select.remove(0);
        }
        var opt2 = document.createElement("option");
        opt2.text = "--Select--";
        opt2.value = "";
        select.options.add(opt2);
        for (var i = 0; i < data.length; i++) {

            // console.log(data.length);
            var opt2 = document.createElement("option");
            opt2.text = data[i];
            opt2.value = data[i];
            select.options.add(opt2);
        }

    });

    socket.on("graphDataLoadAdm", function (data) {

        newGraphData(data.graphLabel, data.graphData1, data.graphData2);

        var currentsortby = data.sortmtd;
        var currentYear = data.yearmtd;
        var curentmonth = data.monthmtd;
        var currentuser = data.usermtd;
        console.log(currentYear);

        document.getElementById("sortbyMtd").innerHTML = currentsortby;
        document.getElementById("yearmtd").innerHTML = currentYear;

        document.getElementById("usermtd").innerHTML = currentuser;


        if (currentsortby == "year") {
            document.getElementById("monthmtd").innerHTML = "NIL";
        } else {
            document.getElementById("monthmtd").innerHTML = curentmonth;
        }

    });


    function myFunction() {


        console.log("rer");
        let selection = document.getElementById("sortBy").value;


        if (selection.toString() == "month") {
            document.getElementById("monthSelect").style.visibility = "visible";
        } else {
            document.getElementById("monthSelect").style.visibility = "hidden";

        }


        console.log(selection)


    }

</script>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <span class="copyright">Copyright &copy; CROW 2017</span>
            </div>
            <div class="col-md-4">
                <ul class="list-inline social-buttons">
                    <li><a href="https://twitter.com/crowaikato"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li><a href="https://www.facebook.com/CROWaikato/"><i class="fa fa-facebook"></i></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/15084280"><i class="fa fa-linkedin"></i></a>
                    </li>
                </ul>
            </div>
            <div class="col-md-4">
                <ul class="list-inline quicklinks">
                    <li><img style="width:100%;margin-top:15px;" src="/img/logos/CROW_Full-Logo-black.png"/></a>
                    </li>
                    <!-- <li><a href="#">Terms of Use</a>
                    </li> -->
                </ul>
            </div>
        </div>
    </div>
</footer>


<div class="solutions-modal modal fade" id="loginpop" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" style=" background:rgba(0,0,0,0.8);">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr" style=" background-color: #ffffff;">
                    <div class="rl" style="background-color: #ffffff;">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <h2 style="color: #ffffff;">Welcome</h2>
                            <br>

                            <script src='https://www.google.com/recaptcha/api.js'></script>


                            <form method="post" action="/loginBackend" class="text-center">
                                <div class="row">
                                    <div class="col-md-2"></div>
                                    <div class="form-group text-center col-md-8">

                                        <label style="color: #ffffff;">Email
                                            address</label><br>
                                        <input name="username" type="text" class="form-control"
                                               id="exampleInputEmail1"
                                               aria-describedby="emailHelp" placeholder="Enter email">

                                    </div>
                                </div>


                                <br>

                                <div class="row">

                                    <div class="col-md-2"></div>
                                    <div class="form-group text-center col-md-8">

                                        <label style="color: #ffffff;">Password</label><br>
                                        <input name="password" type="password" class="form-control"
                                               id="exampleInputPassword1" placeholder="Password">

                                    </div>

                                </div>

                                <br>
                                <div class="row center-block">


                                </div>


                                <button type="submit" class="btn btn-primary">Log in</button>
                            </form>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="solutions-modal modal fade" id="solutionsModal1" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <!-- Project Details Go Here -->
                            <h2>Project Name</h2>
                            <p class="item-intro text-muted">Lorem ipsum dolor sit amet consectetur.</p>
                            <img class="img-responsive img-centered" src="/img/portfolio/roundicons-free.png"
                                 alt="">
                            <p>Use this area to describe your project. Lorem ipsum dolor sit amet, consectetur
                                adipisicing elit. Est blanditiis dolorem culpa incidunt minus dignissimos deserunt
                                repellat aperiam quasi sunt officia expedita beatae cupiditate, maiores repudiandae,
                                nostrum, reiciendis facere nemo!</p>
                            <p>
                                <strong>Want these icons in this portfolio item sample?</strong>You can download 60
                                of
                                them for free, courtesy of <a
                                    href="https://getdpd.com/cart/hoplink/18076?referrer=bvbo4kax5k8ogc">RoundIcons.com</a>,
                                or you can purchase the 1500 icon set <a
                                    href="https://getdpd.com/cart/hoplink/18076?referrer=bvbo4kax5k8ogc">here</a>.
                            </p>
                            <ul class="list-inline">
                                <li>Date: July 2014</li>
                                <li>Client: Round Icons</li>
                                <li>Category: Graphic Design</li>
                            </ul>
                            <button type="button" class="btn btn-primary" data-dismiss="modal"><i
                                    class="fa fa-times"></i> Close Project
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Portfolio Modal 2 -->
<div class="solutions-modal modal fade" id="solutionsModal2" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <h2>Project Heading</h2>
                            <p class="item-intro text-muted">Lorem ipsum dolor sit amet consectetur.</p>
                            <img class="img-responsive img-centered"
                                 src="/img/portfolio/startup-framework-preview.png"
                                 alt="">
                            <p><a href="http://designmodo.com/startup/?u=787">Startup Framework</a> is a website
                                builder
                                for professionals. Startup Framework contains components and complex blocks
                                (PSD+HTML
                                Bootstrap themes and templates) which can easily be integrated into almost any
                                design.
                                All of these components are made in the same style, and can easily be integrated
                                into
                                projects, allowing you to create hundreds of solutions for your future projects.</p>
                            <p>You can preview Startup Framework <a
                                    href="http://designmodo.com/startup/?u=787">here</a>.
                            </p>
                            <button type="button" class="btn btn-primary" data-dismiss="modal"><i
                                    class="fa fa-times"></i> Close Project
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Portfolio Modal 3 -->
<div class="solutions-modal modal fade" id="solutionsModal3" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <!-- Project Details Go Here -->
                            <h2>Project Name</h2>
                            <p class="item-intro text-muted">Lorem ipsum dolor sit amet consectetur.</p>
                            <img class="img-responsive img-centered" src="/img/portfolio/treehouse-preview.png"
                                 alt="">
                            <p>Treehouse is a free PSD web template built by <a
                                    href="https://www.behance.net/MathavanJaya">Mathavan Jaya</a>. This is bright
                                and
                                spacious design perfect for people or startup companies looking to showcase their
                                apps
                                or other projects.</p>
                            <p>You can download the PSD template in this portfolio sample item at <a
                                    href="http://freebiesxpress.com/gallery/treehouse-free-psd-web-template/">FreebiesXpress.com</a>.
                            </p>
                            <button type="button" class="btn btn-primary" data-dismiss="modal"><i
                                    class="fa fa-times"></i> Close Project
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Portfolio Modal 4 -->
<div class="solutions-modal modal fade" id="solutionsModal4" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <!-- Project Details Go Here -->
                            <h2>Project Name</h2>
                            <p class="item-intro text-muted">Lorem ipsum dolor sit amet consectetur.</p>
                            <img class="img-responsive img-centered" src="/img/portfolio/golden-preview.png" alt="">
                            <p>Start Bootstrap's Agency theme is based on Golden, a free PSD website template built
                                by
                                <a href="https://www.behance.net/MathavanJaya">Mathavan Jaya</a>. Golden is a modern
                                and
                                clean one page web template that was made exclusively for Best PSD Freebies. This
                                template has a great portfolio, timeline, and meet your team sections that can be
                                easily
                                modified to fit your needs.</p>
                            <p>You can download the PSD template in this portfolio sample item at <a
                                    href="http://freebiesxpress.com/gallery/golden-free-one-page-web-template/">FreebiesXpress.com</a>.
                            </p>
                            <button type="button" class="btn btn-primary" data-dismiss="modal"><i
                                    class="fa fa-times"></i> Close Project
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Portfolio Modal 5 -->
<div class="solutions-modal modal fade" id="solutionsModal5" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <!-- Project Details Go Here -->
                            <h2>Project Name</h2>
                            <p class="item-intro text-muted">Lorem ipsum dolor sit amet consectetur.</p>
                            <img class="img-responsive img-centered" src="/img/portfolio/escape-preview.png" alt="">
                            <p>Escape is a free PSD web template built by <a
                                    href="https://www.behance.net/MathavanJaya">Mathavan Jaya</a>. Escape is a one
                                page
                                web template that was designed with agencies in mind. This template is ideal for
                                those
                                looking for a simple one page solution to describe your business and offer your
                                services.</p>
                            <p>You can download the PSD template in this portfolio sample item at <a
                                    href="http://freebiesxpress.com/gallery/escape-one-page-psd-web-template/">FreebiesXpress.com</a>.
                            </p>
                            <button type="button" class="btn btn-primary" data-dismiss="modal"><i
                                    class="fa fa-times"></i> Close Project
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Portfolio Modal 6 -->
<div class="solutions-modal modal fade" id="solutionsModal6" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <!-- Project Details Go Here -->
                            <h2>Project Name</h2>
                            <p class="item-intro text-muted">Lorem ipsum dolor sit amet consectetur.</p>
                            <img class="img-responsive img-centered" src="/img/portfolio/dreams-preview.png" alt="">
                            <p>Dreams is a free PSD web template built by <a
                                    href="https://www.behance.net/MathavanJaya">Mathavan Jaya</a>. Dreams is a
                                modern
                                one page web template designed for almost any purpose. It’s a beautiful template
                                that’s
                                designed with the Bootstrap framework in mind.</p>
                            <p>You can download the PSD template in this portfolio sample item at <a
                                    href="http://freebiesxpress.com/gallery/dreams-free-one-page-web-template/">FreebiesXpress.com</a>.
                            </p>
                            <button type="button" class="btn btn-primary" data-dismiss="modal"><i
                                    class="fa fa-times"></i> Close Project
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
<!-- Bootstrap Core JavaScript -->
<script src="/vendor/bootstrap/js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

<!-- Contact Form JavaScript -->
<script src="/javascripts/jqBootstrapValidation.js"></script>
<script src="/js/contact_me.js"></script>

<!-- Theme JavaScript -->
<script src="/javascripts/agency.min.js"></script>

